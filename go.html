<!DOCTYPE html>
<html lang="id">
<head>
    <script async src="https://www.googletagmanager.com/gtag/js?id=G-3XZ24YY21V"></script>
    <script>
        window.dataLayer = window.dataLayer || [];
        function gtag(){dataLayer.push(arguments);}
        gtag('js', new Date());
        gtag('config', 'G-3XZ24YY21V');
    </script>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Safelink - Harap Tunggu</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            text-align: center;
            background-color: #f4f4f4;
            margin: 0;
            padding: 50px 20px;
        }
        .container {
            background-color: #fff;
            padding: 30px;
            border-radius: 8px;
            box-shadow: 0 2px 4px rgba(0,0,0,0.1);
            max-width: 500px;
            margin: 0 auto;
        }
        h1 {
            color: #333;
            margin-bottom: 20px;
        }
        #countdown {
            font-size: 2.5em;
            color: #e44d26;
            margin-bottom: 20px;
        }
        #getLinkBtn {
            background-color: #4CAF50;
            color: white;
            padding: 12px 25px;
            font-size: 1.2em;
            border: none;
            border-radius: 5px;
            cursor: pointer;
            margin-top: 20px;
            display: none; /* Sembunyikan tombol sampai countdown selesai */
            text-decoration: none;
            display: inline-block;
        }
        #getLinkBtn:hover {
            background-color: #45a049;
        }
        .ad-space {
            margin-top: 30px;
            padding: 15px;
            background-color: #e0e0e0;
            border-radius: 5px;
            min-height: 120px;
            display: flex;
            align-items: center;
            justify-content: center;
            color: #555;
            font-style: italic;
            font-size: 0.9em;
            overflow: hidden;
        }
        .error-message {
            color: red;
            font-weight: bold;
        }
    </style>
</head>
<body>
    <div class="container">
        <h1>Harap Tunggu Sebentar...</h1>
        <p>Bab selanjutnya berisi tema dan bahasa yang mungkin tidak sesuai untuk semua usia. Pastikan anda sudah cukup umur.</p>
        <div class="ad-space">
            <script type="text/javascript">
                atOptions = {
                    'key' : '58651f8e0bdb0692fec3afa3d84ec1f6',
                    'format' : 'iframe',
                    'height' : 250,
                    'width' : 300,
                    'params' : {}
                };
            </script>
            <script type="text/javascript" src="//www.highperformanceformat.com/58651f8e0bdb0692fec3afa3d84ec1f6/invoke.js"></script>
        </div>

        <p>Link akan siap dalam: <span id="countdown">10</span> detik</p>
        <a id="getLinkBtn" href="#">Dapatkan Link</a>
    </div>

    <script type='text/javascript' src='//pl27047923.profitableratecpm.com/df/db/bd/dfdbbde324b8fc19f3110521aeee986f.js'></script>

    <script>
        // Fungsi untuk men-decode URL dari Base64
        function decodeUrl(encodedUrl) {
            try {
                return atob(encodedUrl);
            } catch (e) {
                console.error("Error decoding URL:", e);
                return null;
            }
        }

        const urlParams = new URLSearchParams(window.location.search);
        const encodedUrl = urlParams.get('url');
        let countdownTime = 10;

        const countdownElement = document.getElementById('countdown');
        const getLinkBtn = document.getElementById('getLinkBtn');

        // Fungsi untuk memulai countdown dan menampilkan tombol
        function startSafelinkProcess() {
            if (encodedUrl) {
                const decodedUrl = decodeUrl(encodedUrl);

                if (decodedUrl) {
                    const countdownInterval = setInterval(() => {
                        countdownTime--;
                        countdownElement.textContent = countdownTime;
                        if (countdownTime <= 0) {
                            clearInterval(countdownInterval);
                            countdownElement.parentNode.style.display = 'none';
                            getLinkBtn.style.display = 'block';
                            getLinkBtn.href = decodedUrl;
                            getLinkBtn.target = "_blank";
                        }
                    }, 1000);
                } else {
                    document.querySelector('.container').innerHTML = '<p class="error-message">Error: URL tidak dapat didekripsi atau tidak valid!</p>';
                }
            } else {
                document.querySelector('.container').innerHTML = '<p class="error-message">Error: Tidak ada URL yang ditemukan dalam parameter!</p>';
            }
        }

        // Memantau pemuatan script Adsterra kedua (atau script Adsterra yang lebih penting)
        // Ini adalah pendekatan yang lebih baik daripada hanya menunggu onload window
        // karena kita ingin script lain berjalan SETELAH iklan dimuat.
        // Adsterra biasanya akan menambahkan elemen atau variabel global saat dimuat.
        // Kita bisa mengecek keberadaan elemen atau variabel tersebut.

        // Misalnya, jika Adsterra membuat global variable bernama 'AdsterraLoaded'
        // atau jika ada iframe dengan ID tertentu yang dibuat oleh Adsterra, kita bisa cek itu.
        // Karena tidak ada indikator eksplisit di script Anda, kita akan menggunakan
        // pendekatan setTimeout berulang atau mengecek DOM.

        // **Penting:** Identifikasi cara Adsterra mengindikasikan bahwa iklannya sudah *sepenuhnya* dimuat.
        // Tanpa itu, kita hanya bisa menebak dengan penundaan waktu atau pengamatan DOM.

        // Pendekatan 1: Menunggu waktu yang cukup (kurang ideal tapi sering digunakan jika tidak ada callback)
        // setTimeout(() => {
        //     startSafelinkProcess();
        // }, 2000); // Beri waktu 2 detik untuk Adsterra memuat. Sesuaikan nilai ini.

        // Pendekatan 2: Memeriksa apakah script Adsterra kedua sudah dimuat (lebih baik)
        // Asumsi: Jika script dfdbbde324b8fc19f3110521aeee986f.js sudah dimuat, berarti Adsterra siap.
        // Ini bisa dicek dengan memeriksa elemen script di DOM.
        function checkAdsterraLoadedAndStartProcess() {
            const adsterraScript2 = document.querySelector('script[src*="df/db/bd/dfdbbde324b8fc19f3110521aeee986f.js"]');
            if (adsterraScript2 && adsterraScript2.isConnected) { // Cek apakah elemen ada di DOM
                 // Anda juga bisa mengecek apakah iframe iklan sudah muncul
                 const adsterraIframe1 = document.querySelector('iframe[src*="highperformanceformat.com"]');
                 // const adsterraIframe2 = document.querySelector('iframe[src*="profitableratecpm.com"]'); // Jika script kedua juga buat iframe
                 if (adsterraIframe1) { // Periksa apakah setidaknya satu iframe iklan utama sudah ada
                     console.log("Adsterra scripts and iframes appear to be loaded. Starting safelink process.");
                     startSafelinkProcess();
                 } else {
                     console.log("Waiting for Adsterra iframes...");
                     setTimeout(checkAdsterraLoadedAndStartProcess, 100); // Cek lagi setelah 100ms
                 }
            } else {
                console.log("Waiting for Adsterra script 2 to be injected...");
                setTimeout(checkAdsterraLoadedAndStartProcess, 100); // Cek lagi setelah 100ms
            }
        }

        // Panggil fungsi untuk memulai pemeriksaan
        checkAdsterraLoadedAndStartProcess();

    </script>
</body>
</html>
